# cfn-hugo

Cloudformation template for running a static blog generated by Hugo on AWS.

## AWS Architecture

TBD

## Creating the Cloudformation stack

The template for the Cloudformation stack is split across multiple YAML files.
These file are there merged using the
[cform](https://github.com/isubuz/cform) tool.

The final template is generated in the `stack.yml` file. To update the stack,
modify the templates in the the `templates` directory instead of the generated
file.

To generate the merged template, install `cform` and run the following:

```sh
export template="stack.yml"

/path/to/cform merge \
    --source-dir templates \
    --output-file $template \
    --overwrite
```

Now create the stack using -

```sh
# Set stack parameters
export stackname=example-blog
export domain=example.com
export sitename=example
export email=user@example.com

aws cloudformation create-stack \
    --stack-name $stackname \
    --template-body file://$template \
    --capabilities CAPABILITY_IAM \
    --parameters \
        ParameterKey=DomainName,ParameterValue=$domain \
        ParameterKey=SiteName,ParameterValue=$sitename \
        ParameterKey=NotificationEmail,ParameterValue=$email
```
